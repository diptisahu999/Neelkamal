<odoo>

        <template id="external_layout_setneel">
            <t t-if="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id"/>
            </t>
            <t t-if="not o or not 'company_id' in o">
                <t t-set="company" t-value="res_company"/>
            </t>

            <!-- Header Section -->
            <div class="header" style="position: relative;">
                <table style="border: 1pt solid black; width: 100%; font-size: 12px; border-collapse: collapse; height: 155px; border-bottom: none;">
                    <tr>
                        <td width="20%" style="text-align: left; border: none; vertical-align: middle;">
                            <img t-if="company.logo"
                                t-att-src="image_data_uri(company.logo)"
                                style="max-height: 70px; max-width: 100%;"
                                alt="Logo"/>
                        </td>
                        
                        <!-- Updated cell to center the content -->
                        <td width="60%" style="text-align: center; vertical-align: middle; border: none;">
                            <div>
                                <span style="font-weight: bold; font-size: 29px; color: green; text-decoration: underline;">
                                    <span t-field="company.name"/>
                                </span>
                                <br/>
                                <span style="font-size: 15px;">
                                    <span t-field="company.street" style="font-weight: bold;"/><br/>
                                    <span t-if="company.street2" t-field="company.street2"/>
                                    <span t-field="company.city"/>&#160;&#160;
                                    <span t-field="company.state_id.name"/>&#160;&#160;
                                    <span t-field="company.zip"/>
                                </span>
                            </div>
                        </td>
                        
                        <!-- Added a spacer cell to push the content to the center -->
                        <td width="20%" style="text-align: right; border: none; vertical-align: middle;">
                        </td>
                    </tr>
                </table>
            </div>

            <!-- Content Section -->
            <div class="article o_report_layout_standard">
                <t t-raw="0"/>
            </div>
        </template>


        <template id="invoice_template_indiamart" name="Custom Invoice Template">

            <t t-call="neelkamal_invoice_report.external_layout_setneel">
            <main>
                    <t t-foreach="docs" t-as="o">


                    <table style="width:100%; border:1px solid black; border-collapse:collapse; font-size:12px; margin-bottom:0px; padding:0px;">
                        <tr>
                            <td style="width:33%; vertical-align:top; padding:5px; border:none;">
                                <div>
                                    <strong>GSTIN</strong> :
                                    <span t-if="o.company_id.vat" t-field="o.company_id.vat"/>
                                    <t t-if="not o.company_id.vat"> 24AAPFN2619D1ZF </t>
                                </div>
                                <div>
                                    <strong>PAN</strong> :
                                    <span t-if="o.company_id.x_pan_no" t-field="o.company_id.x_pan_no"/>
                                    <t t-if="not o.company_id.x_pan_no"> AAPFN2619D </t>
                                </div>
                                <div>
                                    <strong>MSME</strong> :
                                    <span t-if="o.company_id.x_msme_no" t-field="o.company_id.x_msme_no"/>
                                    <t t-if="not o.company_id.x_msme_no"> GJ-22-0005066 </t>
                                </div>
                            </td>

                            <td style="width:34%; text-align:center; vertical-align:middle; font-size:18px; font-weight:bold; border:none;">
                                TAX INVOICE
                            </td>

                            <td style="width:33%; vertical-align:top; text-align:right; padding:5px; border:none;">
                                <div style="display:inline-block; text-align:left; margin-top:5px;">
                                    <div style="margin-bottom:3px;">
                                        <strong>PHONE</strong> :
                                        <span t-if="o.company_id.mobile" t-field="o.company_id.mobile"/>
                                        <t t-if="o.company_id.mobile and o.company_id.phone"><t t-raw="'&#160;&#160;'"/></t>
                                        <span t-if="o.company_id.phone" t-field="o.company_id.phone"/>
                                        <t t-if="not o.company_id.mobile and not o.company_id.phone">
                                            98251 26642<t t-raw="'&#160;&#160;'"/>
                                        </t>
                                    </div>
                                    <div>
                                        <strong>EMAIL</strong> :
                                        <span t-if="o.company_id.email" t-field="o.company_id.email"/>
                                        <t t-if="not o.company_id.email"> neelkamalind@gmail.com </t>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>


                    <!-- Combined Customer + Invoice Details Section with Borders -->
                    <table style="width:100%; border:0px solid #000; font-size:12px; margin-top:0px; border-collapse:collapse;">
                        <tr>
                            <!-- DETAILS OF RECEIVER (BILLED TO) -->
                            <td style="width:33.3%; vertical-align:top; padding:6px;">
                                <strong>DETAILS OF RECEIVER (BILLED TO)</strong><br/>
                                <strong><span t-field="o.partner_id.name"/></strong><br/>
                                <span t-field="o.partner_id.street"/><br/>
                                <t t-if="o.partner_id.street2"><span t-field="o.partner_id.street2"/><br/></t>
                                <t t-if="o.partner_id.city"><span t-field="o.partner_id.city"/> </t>
                                <t t-if="o.partner_id.state_id"> <span t-field="o.partner_id.state_id.name"/></t>
                                <t t-if="o.partner_id.zip"> <span t-field="o.partner_id.zip"/></t><br/>
                                State : <span t-field="o.partner_id.state_id.name"/>
                                Code : <span t-field="o.partner_id.state_id.code"/><br/><br/>
                                <strong>GSTIN :</strong> <span t-field="o.partner_id.vat"/><br/>
                                <strong>Mobile No.</strong> : <span t-field="o.partner_id.mobile"/>
                            </td>

                            <!-- DETAILS OF CONSIGNEE (SHIPPED TO) -->
                            <td style="width:33.3%; vertical-align:top; padding:6px;">
                                <strong>DETAILS OF CONSIGNEE (SHIPPED TO)</strong><br/>
                                <strong><span t-field="o.partner_shipping_id.name"/></strong><br/>
                                <span t-field="o.partner_shipping_id.street"/><br/>
                                <t t-if="o.partner_shipping_id.street2"><span t-field="o.partner_shipping_id.street2"/><br/></t>
                                <t t-if="o.partner_shipping_id.city"><span t-field="o.partner_shipping_id.city"/> </t>
                                <t t-if="o.partner_shipping_id.state_id"> <span t-field="o.partner_shipping_id.state_id.name"/></t>
                                <t t-if="o.partner_shipping_id.zip"> <span t-field="o.partner_shipping_id.zip"/></t><br/>
                                STATE : <span t-field="o.partner_shipping_id.state_id.name"/>
                                CODE : <span t-field="o.partner_shipping_id.state_id.code"/><br/><br/>
                                <strong>GSTIN :</strong> <span t-field="o.partner_shipping_id.vat"/>
                            </td>

                            <!-- INVOICE DETAILS -->
                            <td style="vertical-align: top; padding:6px; font-size:12px; font-family:Arial, sans-serif;">
                                <strong>INVOICE NO</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: <span t-field="o.name"/><br/>
                                <strong>DATE</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: <span t-field="o.invoice_date" t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/><br/>
                                <strong>CHALLAN NO.</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: <span t-field="o.x_challan_no"/><br/>
                                <strong>P. O. NO.</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: <span t-field="o.ref"/><br/>
                                <strong>Eway Bill No.</strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: <span t-field="o.x_eway_bill_no"/>
                            </td>

                        </tr>
                    </table>



                    <!-- Transport and Other Details in single line format -->
                    <table style="width: 100%; border-collapse: collapse; border: none !important;">
                    <tbody>
                        <tr style="border: none !important;">
                            <td style="padding: 4px; border: none !important;">
                                <strong>Transport :</strong> <span t-field="o.x_transport_name"/>
                            </td>
                            <td style="padding: 4px; border: none !important;">
                                <strong>Vehicle No. :</strong> <span t-field="o.x_vehicle_no"/>
                            </td>

                        </tr>
                        <tr style="border: none !important;">
                        <td style="padding: 4px; border: none !important;">
                            <strong>L.R.No. :</strong> <span t-field="o.x_lr_no"/>
                        </td>
                        <td style="padding: 4px; border: none !important;">
                        <strong>Eway Bill No. :</strong> <span t-field="o.x_eway_bill_no"/>
                        </td>
                        </tr>
                    </tbody>
                    </table>


                    <!-- IRN Details in one line -->
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <!-- Row 1: IRN, Ack No., Ack Date -->
                        <tr>
                            <td style="padding: 5px; border: none; font-weight: bold;">IRN:</td>
                            <td style="padding: 5px; border: none;"></td> <!-- Empty cell for alignment -->
                            <td style="padding: 5px; border: none; font-weight: bold;">Ack No.:</td>
                            <td style="padding: 5px; border: none;"></td> <!-- Empty cell for alignment -->
                            <td style="padding: 5px; border: none; font-weight: bold;">Ack Date:</td>
                            <td style="padding: 5px; border: none;"></td> <!-- Empty cell for alignment -->
                        </tr>
                    </table>


                    <table style="width:100%; border:0px; border-collapse:collapse; font-size:14px; margin-top:0px;">
                        <thead>
                            <tr>
                                <th style="border:1px solid black; text-align:center;">Sr.No.</th>
                                <th style="border:1px solid black; text-align:center; ">DESCRIPTION</th>
                                <th style="border:1px solid black; text-align:center;">HSN</th>
                                <th style="border:1px solid black; text-align:center;">RATE</th>
                                <th style="border:1px solid black; text-align:center;">RS.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="total_amount" t-value="0"/>
                            <t t-set="line_index" t-value="0"/>
                            <t t-foreach="o.invoice_line_ids" t-as="line">
                                <tr>
                                    <td style="text-align:center;"><t t-esc="line_index + 1"/></td>
                                    <td style="text-align:center;"><span t-field="line.name"/></td>
                                    <td style="text-align:center;"><span t-field="line.product_id.l10n_in_hsn_code"/></td>
                                    <td style="text-align:center;"><span t-field="line.price_unit" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></td>
                                    <td style="text-align:center;"><strong><span t-field="line.price_subtotal" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></strong></td>

                                    <t t-set="total_amount" t-value="total_amount + line.price_subtotal"/>
                                    <t t-set="line_index" t-value="line_index + 1"/>
                                </tr>
                            </t>
                            <tr>
                                <td colspan="3" style="text-align:right; border-top:0px solid black; ;"><strong>TOTAL</strong></td>
                                <td></td>
                                <td style="text-align:center; border-top:1px solid black;"><strong><span t-esc="total_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/></strong></td>
                            </tr>
                        </tbody>
                    </table>


                    <!-- Summary Table -->
                    <table style="width: 100%; font-size: 12px; border-collapse: collapse; border: none; vertical-align: top;">
                        <tbody>
                            <tr>
                                <!-- Left Side: Bank and PO Details -->
                                <td style="padding: 4px; border: none; vertical-align: top;">
                                    <p style="margin: 0;">
                                <!--        <strong>po.no.</strong><span t-field="o.x_po_no"/>-->
                                    </p>
                                    <p style="margin: 0; padding-top: 10px;">
                                        <strong>BANK DETAILS :</strong> <span t-field="o.x_bank_details"/>
                                    </p>
                                    <p style="margin: 0;">
                                        <strong>A/C NO :</strong> <span t-field="o.x_account_no"/>
                                    </p>
                                    <p style="margin: 0;">
                                        <strong>RTGS/NEFT IFSC :</strong> <span t-field="o.x_ifsc_code"/>
                                    </p>
                                </td>


                                <!-- Right Side: Financial Details -->
                                <td style="padding: 4px; border: none !important; vertical-align: top; width: 40%;">
                                <table style="width: 100%; border-collapse: collapse; border: none !important;">
                                    <tbody style="border: none !important;">
                                        <tr style="border: none !important;">
                                <td style="padding: 4px; border: none !important; text-align: left;">
                                    <strong>TAXABLE VALUE</strong>
                                </td>
                                <td style="padding: 4px; border: none !important; text-align: right;">
                                    <!-- Odoo ka standard field istemal karein, yeh hamesha sahi kaam karega -->
                                    <span t-field="o.amount_untaxed" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>

                            <tr style="border: none !important;">
                                    <td style="padding: 4px; border: none !important; text-align: left;">
                                        <strong>+ IGST <span t-field="o.x_igst_rate"/>%</strong>
                                    </td>
                                    <td style="padding: 4px; border: none !important; text-align: right;">
                                        <span t-field="o.x_igst_amount"/>
                                    </td>
                            </tr>
                        </tbody>
                    </table>


                </td>

                        </tr>
                    </tbody>
                </table>




                    <!-- Row 3: Total -->
                    <table style="width: 100%; border-collapse: collapse; margin-top: -1px; font-size: 13px;">
                        <tr>
                            <td colspan="1" style="border: none;">&#160;</td> <!-- No border here -->
                            <td style="text-align: right; font-weight: bold; border: none;">TOTAL RS.:</td> <!-- No border here -->
                            <td style="text-align: center; font-weight: bold; border: none;">
                                <span t-field="o.amount_total" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                            </td> <!-- No border here -->
                        </tr>
                    </table>


                    <!-- Amount in Words -->
                    <table style="width: 100%; border-collapse: collapse; border: 0px solid black; margin-top: -1px; font-size: 13px;">
                        <tr>
                            <td style="font-weight: bold; padding: 6px;">
                                Rs.: <span t-field="o.amount_total_in_words"/> Only
                            </td>
                        </tr>
                    </table>



                        <!-- TERMS & CONDITIONS -->
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid black; font-size: 11px;">
                        <tr>
                                <td colspan="5" style="border: 1px solid black; padding: 5px;">
                                    <span t-field="o.x_terms_and_conditions"/>
                                </td>
                            </tr>

                        </table>


                        <!-- SIGNATURE SECTION -->
                        <table style="width: 100%; border-collapse: collapse; font-size: 11px; border: none !important; margin: 0;">
                            <!-- Row 1: E&O.E and For Company -->
                            <tr style="border: none !important;">
                                <td colspan="2" style="padding: 5px; font-weight: bold; text-align: left; border: none !important;">
                                    E.&amp;O.E
                                </td>
                                <td colspan="2" style="padding: 5px; font-weight: bold; text-align: right; border: none !important;">
                                    For: <span t-field="o.company_id.name"/>
                                </td>
                            </tr>

                            <!-- Row 2: Spacer -->
                            <tr style="height: 60px; border: none !important;">
                                <td colspan="4" style="border: none !important;"></td>
                            </tr>



                            <tr style="border: none !important;">
                                <td style="padding: 5px; font-weight: bold; text-align: left; border: none !important; width: 33%;">
                                    RECEIVED BY: <span t-esc="o.received_by"/>
                                </td>

                                <td style="padding: 5px; font-weight: bold; text-align: center; border: none !important; width: 34%;">
                                    PREPARED BY<br/>
                                        <t t-if="o.prepared_by">
                                            <span t-esc="o.prepared_by.name"/>
                                        </t>
                                        <t t-else="">
                                            <span>---</span> <!-- Or write 'Not Assigned' if preferred -->
                                        </t>
                                    </td>

                                    <td colspan="3" style="padding: 5px; font-weight: bold; text-align: right; border: none !important; width: 33%;">
                                        AUTHORISED SIGNATORY : <span t-esc="o.authorized_signatory"></span><br/>
                                        <span style="font-size: 10px;">[MCS - +91-261-2592000]</span>
                                    </td>
                            </tr>

                            <!-- Row 4: Footer Info (if it exists) -->
                            <tr t-if="o.x_report_footer_info" style="border: none !important;">
                                <td colspan="5" style="font-size: 9px; padding: 2px 5px; border: none !important;">
                                    <span t-esc="o.x_report_footer_info"/>
                                </td>
                            </tr>

                            
                        </table>






                        </t>

            </main>
            <!-- </t> -->
            </t>
        </template>



        <template id="report_tax_invoice_neel">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="neelkamal_invoice_report.invoice_template_indiamart" t-lang="lang"/>
                </t>
            </t>
        </template>



</odoo>